<Project>

    <UsingTask TaskName="BlazorLazyLoading.LoadDLLInfo" AssemblyFile="$(_NugetBuildPath)ManifestGenerator.dll" />
    
    <Target Name="CreateGitIgnore" BeforeTargets="PrepareForBuild">
        <WriteLinesToFile
            Condition="!Exists('$(ModuleWwwRootPath).gitignore')"
            File="$(ModuleWwwRootPath).gitignore"
            Lines="$(ModuleLazyDir)/"/>
    </Target>

    <Target Name="CleanBin" BeforeTargets="Clean;Rebuild">
        <RemoveDir Directories="$(ModuleLazyPath)" />
    </Target>

    <Target Name="CopyDependencies" AfterTargets="Build">

        <LoadDLLInfo />

        <PropertyGroup>
            <ProjectOutDir>$(MSBuildProjectDirectory)/$(OutDir)/</ProjectOutDir>
        </PropertyGroup>

        <ItemGroup>
            <OutputFiles Include="$(ProjectOutDir)**/*.*" />
            <OutputFiles Include="@(ReferenceCopyLocalPaths)" />
        </ItemGroup>

        <Copy
            SourceFiles="@(OutputFiles)"
            DestinationFolder="$(ModuleLazyPath)"
            OverwriteReadOnlyFiles="true"
            SkipUnchangedFiles="false" />

    </Target>

</Project>
